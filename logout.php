<?php
//--------------------------------------------
// ログアウト処理ページ（logout.php）
//--------------------------------------------
// セッション情報を完全に破棄し、ログインページへリダイレクトする。

//-----------------------------
// セッション開始
//-----------------------------
session_start();

//-----------------------------
// セッション変数を全削除
//-----------------------------
// $_SESSION配列に保存されたユーザー情報を空にする。
$_SESSION = [];

//-----------------------------
// セッションCookieも削除（安全対策）
//-----------------------------
// Cookieを利用してセッションIDを保持している場合、
// クライアント側にも残らないように期限切れを設定して削除する。
if (ini_get("session.use_cookies")) {
    $params = session_get_cookie_params(); // 現在のCookie設定を取得
    setcookie(
        session_name(), // セッション名（例：PHPSESSID）
        '',             // 空値を設定
        time() - 42000, // 過去の時刻を指定 → 即時期限切れ
        $params["path"],
        $params["domain"],
        $params["secure"],
        $params["httponly"]
    );
}

//-----------------------------
// サーバ側のセッション自体を破棄
//-----------------------------
session_destroy();

//-----------------------------
// ログインページへリダイレクト
//-----------------------------
header('Location: login.php');
exit;
?>
